---
title: "TasasEmpleoJulio"
author: "Julio"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




```{r}
rm(list = ls())
library("readr")
library("tidyverse")
library("dplyr")
```



```{r}
getOption("encoding")
guess_encoding("./data/Indicadores.csv")
```
El encoding es el que tenemos. Se importan los datos

```{r}
# Leer el archivo con la codificación especificada
df <- read_delim("./data/Indicadores.csv", delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", grouping_mark = "."), trim_ws = TRUE)
# Mostrar las primeras filas del archivo
head(df)
```


```{r}
sapply(df, function(x) sum(is.na(x)))
sapply(df, class)
```
La variable Total es de tipo character cuando debería ser numérica.

```{r}
df$Total <- gsub("\\.", "", df$Total) # Eliminar separadores de miles
df$Total <- gsub(",", ".", df$Total) # Cambia los comas por puntos para que R los lea como decimales
df$Total <- as.numeric(df$Total) # Transforma a tipo numérico
```

```{r}
df$Periodo <- as.Date(paste0(df$Periodo, "-01-01")) #Transformar a tipo fecha
```


```{r}
sapply(df, function(x) sum(is.na(x)))
sapply(df, class)
```

¿No se por qué aumentan un poco los datos faltantes?



Transformamos el dataset de manera que quede cada indicador como una variable nueva.

```{r}
df1<- df %>% pivot_wider(names_from="Indicadores", values_from="Total") # Transformar el dataset más ancho (Variable por indicador)
```


```{r}
sapply(df1, class)
```




```{r}
sapply(df1, function(x) sum(is.na(x)))
```

Los datos faltantes en la variable Municipios son los valores asociados a Total Nacional. Por lo que se va a eliminar la columna Total Nacional y se van a rellenar los NA con el Valor "Total Nacional".

```{r}
df2 <- df1 %>% replace_na(list(Municipios = "Total Nacional")) %>% select(-"Total Nacional")
sapply(df2, function(x) sum(is.na(x)))
```

